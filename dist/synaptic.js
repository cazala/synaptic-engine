!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.synaptic=e():t.synaptic=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),o=i(2),s=n(o),u=i(4),h=n(u),l=i(5),d=n(l),c=i(6),f=n(c),v=i(7),y=n(v),p=i(8),g=n(p),b=i(3),m=n(b),w=i(9),T=n(w),O=i(10),E=n(O),k=i(11),I=n(k),P=i(12),S=n(P),_=i(13),j=n(_),C=i(14),L=n(C),M=i(15),G=n(M),N=i(16),A=n(N),R=i(17),U=n(R),D=i(18),B=n(D),x=i(19),F=n(x),V=i(20),Y=n(V),J=i(21),z=n(J),X=i(22),H=n(X),W=i(23),Z=n(W),q=i(24),K=n(q),Q=i(25),$=n(Q),tt=i(26),et=n(tt);e.default={Engine:a.default,Network:s.default,Trainer:h.default,backends:{ASM:d.default,BLAS:f.default,CPU:y.default,GPU:g.default,Paper:m.default,WebWorker:T.default},layers:{Activation:E.default,Convolution:I.default,Convolution2D:S.default,Convolution3D:j.default,Dense:L.default,Dropout:G.default,Input:A.default,Input2D:U.default,Input3D:B.default,InputToOutput:F.default,LSTM:Y.default,MaxPool:z.default,MaxPool2D:H.default,MaxPool3D:Z.default,ZeroPadding:K.default,ZeroPadding2D:$.default,ZeroPadding3D:et.default}}},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var n,r=e.reduce(function(t,e){return t.concat(e||[])},[]),a={},o=[];for(n=0;n<r.length;a[r[n++]]=1);for(n in a)o.push(+n);return o}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=e.ActivationTypes={LOGISTIC_SIGMOID:0,TANH:1,RELU:2,MAX_POOLING:3,DROPOUT:4,IDENTITY:5},o=e.StatusTypes={IDLE:0,INIT:1,REVERSE_INIT:2,ACTIVATING:3,PROPAGATING:4,TRAINING:5},s={bias:!0,generator:function(){return 2*Math.random()-1}},u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,n=e.bias,r=e.generator;i(this,t),this.state={},this.weight={},this.gain={},this.activation={},this.elegibilityTrace={},this.extendedElegibilityTrace={},this.errorResponsibility={},this.projectedErrorResponsibility={},this.gatedErrorResponsibility={},this.activationFunction={},this.inputsOf={},this.projectedBy={},this.gatersOf={},this.gatedBy={},this.inputsOfGatedBy={},this.projectionSet={},this.gateSet={},this.inputSet={},this.derivativeTerm={},this.connections=[],this.gates=[],this.learningRate=.1,this.layers=[],this.size=0,this.random=r,this.biasUnit=null,this.status=o.IDLE,n&&(this.biasUnit=this.addUnit(),this.activation[this.biasUnit]=1)}return r(t,[{key:"addUnit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.LOGISTIC_SIGMOID,e=this.size;return this.state[e]=this.random(),this.weight[e]={},this.gain[e]={},this.elegibilityTrace[e]={},this.extendedElegibilityTrace[e]={},this.activation[e]=0,this.weight[e][e]=0,this.gain[e][e]=1,this.elegibilityTrace[e][e]=0,this.extendedElegibilityTrace[e][e]={},this.activationFunction[e]=t,this.errorResponsibility[e]=0,this.projectedErrorResponsibility[e]=0,this.gatedErrorResponsibility[e]=0,this.inputsOf[e]=[],this.projectedBy[e]=[],this.gatersOf[e]=[],this.gatedBy[e]=[],this.inputsOfGatedBy[e]={},this.derivativeTerm[e]={},this.inputSet[e]=[],this.projectionSet[e]=[],this.gateSet[e]=[],this.size++,null!=this.biasUnit&&this.addConnection(this.biasUnit,e),e}},{key:"addConnection",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.connections.some(function(i){return i.from===t&&i.to===e})){this.connections.push({from:t,to:e});var n=e,r=t,a=t===e;this.gain[n][r]=1,this.weight[n][r]=a?1:null==i?this.random():i,this.elegibilityTrace[n][r]=0,this.extendedElegibilityTrace[n][r]={},this.track(e),this.track(t)}}},{key:"addGate",value:function(t,e,i){var n=this.gates.some(function(i){return i.from===t&&i.to===e}),r=t===this.biasUnit;n||r||(this.gates.push({from:t,to:e,gater:i}),this.track(e),this.track(t),this.track(i))}},{key:"addLayer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1];if(this.status===o.REVERSE_INIT)throw new Error("You can't add layers during REVERSE_INIT phase!");for(var i=[],n=0;n<t;n++){var r=this.addUnit(e);i.push(r)}return this.layers.push(i),i}},{key:"track",value:function(t){var e=this;this.inputsOf[t]=n(this.connections.filter(function(e){return e.to===t}).map(function(t){return t.from})),this.projectedBy[t]=n(this.connections.filter(function(e){return e.from===t}).map(function(t){return t.to})),this.gatersOf[t]=n(this.gates.filter(function(e){return e.to===t}).map(function(t){return t.gater})),this.gatedBy[t]=n(this.gates.filter(function(e){return e.gater===t}).map(function(t){return t.to})),this.inputsOf[t].forEach(function(i){e.gatedBy[t].forEach(function(n){e.extendedElegibilityTrace[t][i][n]=0})}),this.projectedBy[t].forEach(function(i){e.gatedBy[i].forEach(function(n){e.extendedElegibilityTrace[i][t][n]=0})}),this.gatersOf[t].forEach(function(i){e.inputsOf[i].forEach(function(n){e.extendedElegibilityTrace[i][n][t]=0})}),this.inputsOf[t].forEach(function(i){e.gatersOf[t].forEach(function(r){e.inputsOfGatedBy[t][r]=n(e.inputsOfGatedBy[t][r],e.gates.filter(function(e){return e.gater===r&&e.to===t&&e.from===i&&e.to!==e.from}).map(function(t){return t.from}))})}),this.gatedBy[t].forEach(function(i){e.inputsOf[i].forEach(function(r){e.inputsOfGatedBy[i][t]=n(e.inputsOfGatedBy[i][t],e.gates.filter(function(e){return e.gater===t&&e.to===i&&e.from===r&&e.to!==e.from}).map(function(t){return t.from}))})}),this.gatedBy[t].forEach(function(i){e.derivativeTerm[i][t]=e.gates.some(function(e){return e.to===i&&e.from===i&&e.gater===t})?1:0}),this.gatersOf[t].forEach(function(i){e.derivativeTerm[t][i]=e.gates.some(function(e){return e.to===t&&e.from===t&&e.gater===i})?1:0}),this.inputSet[t]=this.inputsOf[t].filter(function(e){return e!==t}),this.projectionSet[t]=this.projectedBy[t].filter(function(e){return e>t}),this.gateSet[t]=this.gatedBy[t].filter(function(e){return e>t})}},{key:"toJSON",value:function(){return JSON.stringify({state:this.state,weight:this.weight,gain:this.gain,activation:this.activation,elegibilityTrace:this.elegibilityTrace,extendedElegibilityTrace:this.extendedElegibilityTrace,errorResponsibility:this.errorResponsibility,projectedErrorResponsibility:this.projectedErrorResponsibility,gatedErrorResponsibility:this.gatedErrorResponsibility,activationFunction:this.activationFunction,inputsOf:this.inputsOf,projectedBy:this.projectedBy,gatersOf:this.gatersOf,gatedBy:this.gatedBy,inputsOfGatedBy:this.inputsOfGatedBy,projectionSet:this.projectionSet,gateSet:this.gateSet,inputSet:this.inputSet,derivativeTerm:this.derivativeTerm,connections:this.connections,gates:this.gates,learningRate:this.learningRate,layers:this.layers,size:this.size,biasUnit:this.biasUnit})}},{key:"clone",value:function(){return t.fromJSON(this.toJSON())}},{key:"clear",value:function(){}}]),t}();e.default=u,u.fromJSON=function(t){var e=JSON.parse(t),i=new u;return Object.keys(e).forEach(function(t){return i[t]=e[t]}),i}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){return t[0].layers&&!t[0].init&&!t[0].reverseInit}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=i(1),h=n(u),l=i(3),d=n(l),c=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];a(this,t);var n=void 0;if(o(i)){if("backend"in i)this.backend=i.backend;else if("engine"in i)this.backend=new d.default(i.engine);else if("bias"in i||"generator"in i){var s=new h.default(i);this.backend=new d.default(s)}n=i.layers}else this.backend=new d.default,n=[].concat(r(i));this.engine=this.backend.engine;var l=null,c=null;this.engine.status=u.StatusTypes.INIT;var f=[];n.forEach(function(t){l=t.init&&t.init(e,l)||l,f.push(l)}),this.engine.status=u.StatusTypes.REVERSE_INIT,f.reverse(),n.reverse().forEach(function(t,i){c=f[i-1]||c,t.reverseInit&&t.reverseInit(e,c)}),this.engine.status=u.StatusTypes.IDLE}return s(t,[{key:"addUnit",value:function(){return this.engine.addUnit()}},{key:"addConnection",value:function(t,e,i){return this.engine.addConnection(t,e,i)}},{key:"addGate",value:function(t,e,i){return this.engine.addGate(t,e,i)}},{key:"addLayer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.engine.addLayer(t*e*i)}},{key:"getLayers",value:function(){return this.engine.layers.slice()}},{key:"toJSON",value:function(){return this.engine.toJSON()}},{key:"clone",value:function(){return t.fromJSON(this.toJSON())}},{key:"activate",value:function(t){return this.backend.activate(t)}},{key:"propagate",value:function(t){this.backend.propagate(t)}}]),t}();e.default=c,c.fromJSON=function(t){var e=h.default.fromJSON(t);return new c({engine:e})}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){return t.reduce(function(t,i){return t+e(i)},0)}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=i(1),h=n(u),l=i(4),d=function(){function t(e){r(this,t),this.engine=e||new h.default}return s(t,[{key:"activateUnit",value:function(t,e){var i=t,n=this.engine.state,r=this.engine.weight,o=this.engine.gain,s=this.engine.activation,u=this.activationFunction,h=this.activationFunctionDerivative,l=this.engine.elegibilityTrace,d=this.engine.extendedElegibilityTrace,c=this.engine.inputSet,f=this.engine.gatedBy,v=this.engine.inputsOfGatedBy;if("undefined"!=typeof e)s[i]=e;else{n[i]=o[i][i]*r[i][i]*n[i]+a(c[i],function(t){return o[i][t]*r[i][t]*s[t]}),s[i]=u(i);var y=!0,p=!1,g=void 0;try{for(var b,m=c[i][Symbol.iterator]();!(y=(b=m.next()).done);y=!0){var w=b.value;l[i][w]=o[i][i]*r[i][i]*l[i][w]+o[i][w]*s[w];var T=!0,O=!1,E=void 0;try{for(var k,I=f[i][Symbol.iterator]();!(T=(k=I.next()).done);T=!0){var P=k.value;d[i][w][P]=o[P][P]*r[P][P]*d[i][w][P]+h(i)*l[i][w]*this.bigParenthesisTerm(P,i)}}catch(t){O=!0,E=t}finally{try{!T&&I.return&&I.return()}finally{if(O)throw E}}}}catch(t){p=!0,g=t}finally{try{!y&&m.return&&m.return()}finally{if(p)throw g}}var S=!0,_=!1,j=void 0;try{for(var C,L=f[t][Symbol.iterator]();!(S=(C=L.next()).done);S=!0){var M=C.value,G=!0,N=!1,A=void 0;try{for(var R,U=v[M][t][Symbol.iterator]();!(G=(R=U.next()).done);G=!0){var D=R.value;o[M][D]=s[t]}}catch(t){N=!0,A=t}finally{try{!G&&U.return&&U.return()}finally{if(N)throw A}}}}catch(t){_=!0,j=t}finally{try{!S&&L.return&&L.return()}finally{if(_)throw j}}}return s[i]}},{key:"propagateUnit",value:function(t,e){var i=this,n=t,r=(this.engine.state,this.engine.weight),o=this.engine.gain,s=this.engine.activation,u=this.activationFunctionDerivative,h=this.engine.errorResponsibility,l=this.engine.projectedErrorResponsibility,d=this.engine.gatedErrorResponsibility,c=this.engine.learningRate,f=this.engine.elegibilityTrace,v=this.engine.extendedElegibilityTrace,y=this.engine.projectionSet,p=this.engine.gateSet,g=this.engine.inputSet;"undefined"!=typeof e?h[n]=l[n]=e-s[n]:(l[n]=u(n)*a(y[n],function(t){return h[t]*o[t][n]*r[t][n]}),d[n]=u(n)*a(p[n],function(t){return h[t]*i.bigParenthesisTerm(t,n)}),h[n]=l[n]+d[n]);var b=!0,m=!1,w=void 0;try{for(var T,O=function(){var t=T.value,e=c*l[n]*f[n][t]+c*a(p[n],function(e){return h[e]*v[n][t][e]});r[n][t]+=e},E=g[n][Symbol.iterator]();!(b=(T=E.next()).done);b=!0)O()}catch(t){m=!0,w=t}finally{try{!b&&E.return&&E.return()}finally{if(m)throw w}}}},{key:"bigParenthesisTerm",value:function(t,e){var i=this.engine.weight,n=this.engine.state,r=this.engine.activation,o=this.engine.derivativeTerm[t][e],s=this.engine.inputsOfGatedBy[t][e];return o*i[t][t]*n[t]+a(s,function(e){return i[t][e]*r[e]})}},{key:"activationFunction",value:function(t){var e=this,i=void 0,n=this.engine.activationFunction[t],r=function(){switch(n){case u.ActivationTypes.LOGISTIC_SIGMOID:return i=e.engine.state[t],{v:1/(1+Math.exp(-i))};case u.ActivationTypes.TANH:i=e.engine.state[t];var r=Math.exp(i),a=1/r;return{v:(r-a)/(r+a)};case u.ActivationTypes.RELU:return i=e.engine.state[t],{v:i>0?i:0};case u.ActivationTypes.IDENTITY:return i=e.engine.state[t],{v:i};case u.ActivationTypes.MAX_POOLING:var o=e.engine.inputsOf[t][0],s=e.engine.gatedBy[t][0],h=e.engine.inputsOfGatedBy[s][t],l=h.reduce(function(t,i){return Math.max(e.engine.activation[i],t)},-(1/0));h.find(function(t){return e.engine.activation[t]===l});return{v:inputWithHigherActivation===o?1:0};case u.ActivationTypes.DROPOUT:var d=e.engine.state[t];return{v:e.engine.random()<d&&e.engine.status===u.StatusTypes.TRAINING?0:1}}}();if("object"===("undefined"==typeof r?"undefined":o(r)))return r.v}},{key:"activationFunctionDerivative",value:function(t){var e=void 0,i=this.engine.activationFunction[t];switch(i){case u.ActivationTypes.LOGISTIC_SIGMOID:return e=this.activationFunction(t),e*(1-e);case u.ActivationTypes.TANH:return e=this.activationFunction(t),1-Math.pow(e,2);case u.ActivationTypes.RELU:return 0;case u.ActivationTypes.IDENTITY:return 0;case u.ActivationTypes.MAX_POOLING:return 0;case u.ActivationTypes.DROPOUT:return 0}}},{key:"costFunction",value:function(t,e,i){var n=void 0,r=0;switch(i){case l.CostTypes.MSE:for(n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r/t.length;case l.CostTypes.CROSS_ENTROPY:for(n=0;n<t.length;n++)r-=t[n]*Math.log(e[n]+1e-15)+(1-t[n])*Math.log(1+1e-15-e[n]);return r;case l.CostTypes.BINARY:for(n=0;n<t.length;n++)r+=Math.round(2*t[n])!=Math.round(2*e[n]);return r}}},{key:"activate",value:function(t){var e=this;this.engine.status=u.StatusTypes.ACTIVATING;var i=this.engine.layers.map(function(i,n){return i.map(function(i,r){var a=0===n?t[r]:void 0;e.activateUnit(i,a)})});return this.engine.status=u.StatusTypes.IDLE,i.pop()}},{key:"propagate",value:function(t){var e=this;this.engine.status=u.StatusTypes.PROPAGATING,this.engine.layers.slice(1).reverse().forEach(function(i,n){i.slice().reverse().forEach(function(i,r){var a=0===n?t[r]:void 0;e.activateUnit(i,a)})}),this.engine.status=u.StatusTypes.IDLE}},{key:"train",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.defaults,n=i.learningRate,r=i.minError,a=i.maxIterations,o=i.costFunction;return new Promise(function(i){var s=new Date,h=0,l=0;for(e.engine.learningRate=n,e.engine.status=u.StatusTypes.TRAINING;h>r&&l<a;){var d=!0,c=!1,f=void 0;try{for(var v,y=t[Symbol.iterator]();!(d=(v=y.next()).done);d=!0){var p=v.value,g=p.input,b=p.output,m=e.activate(g);e.propagate(b),h+=e.costFunction(b,m,o)}}catch(t){c=!0,f=t}finally{try{!d&&y.return&&y.return()}finally{if(c)throw f}}h/=t.length,l++}e.engine.status=u.StatusTypes.IDLE,i({error:h,iterations:l,time:new Date-s})})}}]),t}();e.default=d},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=e.CostTypes={MSE:0,CROSS_ENTROPY:1,BINARY:2},a=(e.defaults={learningRate:.1,minError:.05,maxIterations:2e3,costFunction:r.MSE},function(){function t(e){i(this,t),this.network=e}return n(t,[{key:"train",value:function(t,e){return network.backend.train(t,e)}},{key:"test",value:function(t,e){}}]),t}());e.default=a},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.ReLU=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1);e.ReLU=function(){function t(){n(this,t),this.layer=null}return r(t,[{key:"init",value:function(t,e){var i=e.layer;this.layer=t.addLayer(i.length,a.ActivationTypes.RELU);for(var n=0;n<i.length;n++)t.addConnection(i[n],this.layer[n],1)}}]),t}()},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){var n=e.filter,r=void 0===n?1:n,a=e.height,o=void 0===a?1:a,s=e.depth,u=void 0===s?1:s,h=e.stride,l=void 0===h?1:h,d=e.padding,c=void 0===d?0:d;i(this,t),this.filter=r,this.height=o,this.depth=u,this.stride=l,this.padding=c,this.layer=null}return n(t,[{key:"init",value:function(t,e){this.layer=t.addLayer();var i=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,u=void 0,h=void 0;for(r=0;r<this.depth;r++)for(n=0;n<this.height;n++)for(i=this.padding;i<e.width-this.padding;i+=this.stride){var l=t.addUnit();this.layer.push(l);for(var d=this.filter/2,c=-d;c<d;c++)for(a=Math.round(i+c),s=0;s<e.depth;s++)for(o=0;o<e.height;o++)this.isValid(e,a,o,s)&&(h=l,u=e.layer[a+o*e.height+s*e.height*e.depth],t.addConnection(u,h))}return{width:e.width/this.stride|0,height:this.height,depth:this.depth,layer:this.layer}}},{key:"isValid",value:function(t,e,i,n){return e>0&&e<t.width&&i>0&&i<t.height}}]),t}();e.default=r},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){var n=e.filter,r=void 0===n?1:n,a=e.depth,o=void 0===a?1:a,s=e.stride,u=void 0===s?1:s,h=e.padding,l=void 0===h?0:h;i(this,t),this.filter=r,this.depth=o,this.stride=u,this.padding=l,this.layer=null}return n(t,[{key:"init",value:function(t,e){this.layer=t.addLayer();var i=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,u=void 0,h=void 0;for(r=0;r<this.depth;r++)for(n=this.padding;n<e.height-this.padding;n+=this.stride)for(i=this.padding;i<e.width-this.padding;i+=this.stride){var l=t.addUnit();this.layer.push(l);for(var d=this.filter/2,c=-d;c<d;c++)for(var f=-d;f<d;f++)for(a=Math.round(i+f),o=Math.round(n+c),s=0;s<e.depth;s++)this.isValid(e,a,o,s)&&(h=l,u=e.layer[a+o*e.height+s*e.height*e.depth],t.addConnection(u,h))}return{width:(e.width-this.padding)/this.stride|0,height:(e.height-this.padding)/this.stride|0,depth:this.depth,layer:this.layer}}},{key:"isValid",value:function(t,e,i,n){return e>0&&e<t.width&&i>0&&i<t.height}}]),t}();e.default=r},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){var n=e.filter,r=void 0===n?1:n,a=e.stride,o=void 0===a?1:a,s=e.padding,u=void 0===s?0:s;i(this,t),this.filter=r,this.stride=o,this.padding=u,this.layer=null}return n(t,[{key:"init",value:function(t,e){this.layer=t.addLayer();var i=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,u=void 0,h=void 0;for(r=this.padding;r<e.depth-this.padding;r+=this.stride)for(n=this.padding;n<e.height-this.padding;n+=this.stride)for(i=this.padding;i<e.width-this.padding;i+=this.stride){var l=t.addUnit();this.layer.push(l);for(var d=this.filter/2,c=-d;c<d;c++)for(var f=-d;f<d;f++)for(var v=-d;v<d;v++)a=Math.round(i+v),o=Math.round(n+f),s=Math.round(n+c),this.isValid(e,a,o,s)&&(h=l,u=e.layer[a+o*e.height+s*e.height*e.depth],t.addConnection(u,h))}return{width:e.width/this.stride|0,height:e.height/this.stride|0,depth:e.depth/this.stride|0,layer:this.layer}}},{key:"isValid",value:function(t,e,i,n){return e>0&&e<t.width&&i>0&&i<t.height}}]),t}();e.default=r},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){i(this,t),this.layer=null}return n(t,[{key:"init",value:function(t,e){var i=this;return this.layer=t.addLayer(this.size),e.layer.forEach(function(e){i.layer.forEach(function(i){t.addConnection(e,i)})}),{width:this.size,height:1,depth:1,layer:this.layer}}}]),t}();e.default=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=function(){function t(e){n(this,t),this.chances=e,this.gater=null,this.layer=null}return r(t,[{key:"init",value:function(t,e){this.gater=t.addLayer(),this.layer=t.addLayer();for(var i=void 0,n=void 0,r=void 0,o=0;x<e.layer.length;o++){i=t.addUnit(a.ActivationTypes.IDENTITY),this.layer.push(i),n=e.layer[o],r=i;var s=t.addUnit(a.ActivationTypes.DROPOUT);t.addGate(n,r,s),this.gater.push(s),t.engine.state[s]=this.chances,t.addConnection(s,s)}}}]),t}();e.default=o},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){i(this,t),this.size=e,this.layer=null}return n(t,[{key:"init",value:function(t,e){return this.layer=t.addLayer(this.size),{width:this.size,height:1,depth:1,layer:this.layer}}}]),t}();e.default=r},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e,n){i(this,t),this.width=e,this.height=n,this.layer=null}return n(t,[{key:"init",value:function(t,e){return this.layer=t.addLayer(this.width,this.height),{width:this.width,height:this.height,depth:1,layer:this.layer}}}]),t}();e.default=r},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e,n,r){i(this,t),this.width=e,this.height=n,this.depth=r,this.layer=null}return n(t,[{key:"init",value:function(t,e){return this.layer=t.addLayer(this.width,this.height,this.depth),{width:this.width,height:this.height,depth:this.depth,layer:this.layer}}}]),t}();e.default=r},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.Direct=function(){function t(){i(this,t)}return n(t,[{key:"reverseInit",value:function(t,e){var i=t.getLayers(),n=i[0],r=i[i.length-1];n.forEach(function(e){r.forEach(function(i){t.addConnection(e,i)})})}}]),t}()},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e,i,n){e.forEach(function(n,r){i.forEach(function(a,o){e===i&&r!==o||t.addConnection(n,a)})})}function r(t,e,i,n){for(var r=void 0,a=void 0,o=void 0,s=function(s){switch(n){case"SELF":r=i[s],a=i[s],o=e[s],t.addGate(r,a,o);break;case"INBOUND":a=i[s],o=e[s],t.engine.connections.filter(function(t){return t.to===a}).filter(function(t){return t.from!==a}).map(function(t){return t.from}).forEach(function(e){return t.addGate(e,a,o)});break;case"OUTBOUND":i.forEach(function(n){r=i[s],o=e[s],t.engine.connections.filter(function(t){return t.from===r}).filter(function(t){return t.to!==r}).map(function(t){return t.to}).forEach(function(e){return t.addGate(r,e,o)})})}},u=0;u<e.length;u++)s(u)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o={peepholes:!0},s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=n.peepholes;i(this,t),this.memoryBlocks=e,this.peepholes=r,this.prevLayer=null,this.nextLayer=null,this.inputGate=null,this.forgetGate=null,this.memoryCell=null,this.outputGate=null}return a(t,[{key:"init",value:function(t,e){return this.prevLayer=e.layer,this.inputGate=t.addLayer(this.memoryBlocks),this.forgetGate=t.addLayer(this.memoryBlocks),this.memoryCell=t.addLayer(this.memoryBlocks),this.outputGate=t.addLayer(this.memoryBlocks),n(t,this.prevLayer,this.memoryCell),n(t,this.memoryCell,this.memoryCell),n(t,this.prevLayer,this.inputGate),n(t,this.prevLayer,this.forgetGate),n(t,this.prevLayer,this.outputGate),r(t,this.inputGate,this.memoryCell,"INBOUND"),r(t,this.forgetGate,this.memoryCell,"SELF"),{width:this.memoryCell.length,height:1,depth:1,layer:this.memoryCell}}},{key:"reverseInit",value:function(t,e){this.nextLayer=e.layer,n(network,this.prevLayer,this.nextLayer),r(network,this.outputGate,this.memoryCell,"OUTBOUND"),this.peepholes&&(n(network,this.memoryCell,this.inputGate),n(network,this.memoryCell,this.forgetGate),n(network,this.memoryCell,this.outputGate))}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;n(this,t),this.downsampling=e,this.gater=null,this.layer=null}return r(t,[{key:"init",value:function(t,e){this.gater=t.addLayer(),this.layer=t.addLayer();for(var i=void 0,n=void 0,r=void 0,o=void 0,s=0;i<e.depth;s++)for(var u=0;u<e.height;u++)for(var h=0;h<e.width;h+=this.downsampling){var l=t.addUnit(a.ActivationTypes.IDENTITY);this.layer.push(l);for(var d=0;d<this.downsampling;d++)if(n=h+d,r=u,o=s,this.isValid(e,n,froY,o)){var c=e.layer[n+r*e.height+o*e.height*e.depth],f=l;t.addConnection(c,f,1);var v=t.addUnit(a.ActivationTypes.MAX_POOLING);t.addGate(c,f,v),this.gater.push(v),t.addConnection(c,v)}}return{width:e.width/this.downsampling|0,height:e.height,depth:e.depth,layer:this.layer}}},{key:"isValid",value:function(t,e,i,n){return e>0&&e<t.width&&i>0&&i<t.height}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;n(this,t),this.downsampling=e,this.gater=null,this.layer=null}return r(t,[{key:"init",value:function(t,e){this.gater=t.addLayer(),this.layer=t.addLayer();for(var i=void 0,n=void 0,r=void 0,o=void 0,s=0;i<e.depth;s++)for(var u=0;u<e.height;u+=this.downsampling)for(var h=0;h<e.width;h+=this.downsampling){var l=t.addUnit(a.ActivationTypes.IDENTITY);this.layer.push(l);for(var d=0;d<this.downsampling;d++)for(var c=0;c<this.downsampling;c++)if(n=h+c,r=u+d,o=s,this.isValid(e,n,froY,o)){var f=e.layer[n+r*e.height+o*e.height*e.depth],v=l;t.addConnection(f,v,1);var y=t.addUnit(a.ActivationTypes.MAX_POOLING);t.addGate(f,v,y),this.gater.push(y),t.addConnection(f,y)}}return{width:e.width/this.downsampling|0,height:e.height/this.downsampling|0,depth:e.depth,layer:this.layer}}},{key:"isValid",value:function(t,e,i,n){return e>0&&e<t.width&&i>0&&i<t.height}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),
n&&t(e,n),e}}(),a=i(1),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;n(this,t),this.downsampling=e,this.gater=null,this.layer=null}return r(t,[{key:"init",value:function(t,e){this.gater=t.addLayer(),this.layer=t.addLayer();for(var i=void 0,n=void 0,r=void 0,o=void 0,s=0;i<e.depth;s+=this.downsampling)for(var u=0;u<e.height;u+=this.downsampling)for(var h=0;h<e.width;h+=this.downsampling){var l=t.addUnit(a.ActivationTypes.IDENTITY);this.layer.push(l);for(var d=0;d<this.downsampling;d++)for(var c=0;c<this.downsampling;c++)for(var f=0;f<this.downsampling;f++)if(n=h+f,r=u+c,o=s+d,this.isValid(e,n,froY,o)){var v=e.layer[n+r*e.height+o*e.height*e.depth],y=l;t.addConnection(v,y,1);var p=t.addUnit(a.ActivationTypes.MAX_POOLING);t.addGate(v,y,p),this.gater.push(p),t.addConnection(v,p)}}return{width:e.width/this.downsampling|0,height:e.height/this.downsampling|0,depth:e.depth/this.downsampling|0,layer:this.layer}}},{key:"isValid",value:function(t,e,i,n){return e>0&&e<t.width&&i>0&&i<t.height}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=function(){function t(e){n(this,t),this.padding=e,this.layer=null}return r(t,[{key:"init",value:function(t,e){this.layer=t.addLayer();var i=void 0,n=void 0,r=void 0,o=void 0,s=void 0;for(r=0;r<e.depth;r++)for(n=0;n<e.height;n++)for(i=-this.padding;i<e.width+this.padding;i++){var u=t.addUnit(a.ActivationTypes.IDENTITY);this.layer.push(u),this.isPadding(e,i,n,r)||(s=u,o=e.layer[i+n*e.height+r*e.height*e.depth],t.addConnection(o,s))}return{width:e.width+2*this.padding,height:e.height,depth:e.height,layer:this.layer}}},{key:"isPadding",value:function(t,e,i,n){return e<0||e>t.width||i<0||i>t.height||n<0||n>t.depth}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=function(){function t(e){n(this,t),this.padding=e,this.layer=null}return r(t,[{key:"init",value:function(t,e){this.layer=t.addLayer();var i=void 0,n=void 0,r=void 0,o=void 0,s=void 0;for(r=0;r<e.depth;r++)for(n=-this.padding;n<e.height+this.padding;n++)for(i=-this.padding;i<e.width+this.padding;i++){var u=t.addUnit(a.ActivationTypes.IDENTITY);this.layer.push(u),this.isPadding(e,i,n,r)||(s=u,o=e.layer[i+n*e.height+r*e.height*e.depth],t.addConnection(o,s))}return{width:e.width+2*this.padding,height:e.height+2*this.padding,depth:e.height,layer:this.layer}}},{key:"isPadding",value:function(t,e,i,n){return e<0||e>t.width||i<0||i>t.height||n<0||n>t.depth}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=function(){function t(e){n(this,t),this.padding=e,this.layer=null}return r(t,[{key:"init",value:function(t,e){this.layer=t.addLayer();var i=void 0,n=void 0,r=void 0,o=void 0,s=void 0;for(r=-this.padding;r<e.depth+this.padding;r++)for(n=-this.padding;n<e.height+this.padding;n++)for(i=-this.padding;i<e.width+this.padding;i++){var u=t.addUnit(a.ActivationTypes.IDENTITY);this.layer.push(u),this.isPadding(e,i,n,r)||(s=u,o=e.layer[i+n*e.height+r*e.height*e.depth],t.addConnection(o,s))}return{width:e.width+2*this.padding,height:e.height+2*this.padding,depth:e.height+2*this.padding,layer:this.layer}}},{key:"isPadding",value:function(t,e,i,n){return e<0||e>t.width||i<0||i>t.height||n<0||n>t.depth}}]),t}();e.default=o}])});